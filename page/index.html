<html>
  <head>
    <title>Chat</title>
    <style>
      input {
        display: block;
      }
      ul {
        list-style: none;
      }
    </style>
  </head>
  <body>
    Let's chat

    <ul id="message"></ul>
    <form id="chatbox">
      <textarea></textarea>
      <input type="submit" value="Send" />
    </form>
  </body>

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    var socket = new WebSocket("ws://localhost:8080/room");
    var msgBox = $("#chatbox textarea");
    var messages = $("#message");

    $(function async() {
      $("#chatbox").submit(function () {
        if (!msgBox.val()) return false;

        try {
          socket.send(msgBox.val());
        } catch (error) {
          console.log(error);
        }
        msgBox.val("");
        const abc = $("#message");

        return false;
      });
    });

    socket.onclose = function () {
      alert("연결이 종료 되었습니다.");
    };

    socket.onmessage = function (e) {
      const newLi = document.createElement("li");
      newLi.innerHTML = e.data;
      messages.append(newLi);
    };
  </script>
</html>
